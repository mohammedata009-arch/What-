<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ù…Ø­Ù…Ø¯ Ø·Ù‡ - Ø§Ù„Ù…ÙˆÙ„Ø¯ Ø§Ù„Ù…ØªØ³Ù„Ø³Ù„</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f2f5; text-align: center; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 550px; margin: auto; }
        h2 { color: #075e54; }
        input { padding: 12px; margin: 8px 0; width: 95%; border-radius: 8px; border: 1px solid #ccc; font-size: 15px; box-sizing: border-box; }
        button { padding: 14px; margin: 5px 0; width: 48%; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; color: white; transition: 0.3s; }
        .btn-gen { background: #25D366; width: 100%; }
        .btn-vcf { background: #007bff; width: 100%; }
        .btn-clicked { background: #aaa !important; color: #666 !important; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        .row-checked { background-color: #d1e7dd !important; }
        .wa-link { color: #25D366; text-decoration: none; font-weight: bold; }
        .info-text { font-size: 12px; color: #666; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØ³Ù„Ø³Ù„ ğŸ‡¸ğŸ‡©</h2>
    <p class="info-text">Ø¨ÙˆØ§Ø³Ø·Ø©: Ù…Ø­Ù…Ø¯ Ø·Ù‡ Ø¹Ø·Ø§ Ø§Ù„Ù…Ù†Ø§Ù†</p>
    
    <p class="info-text">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø£ÙˆÙ„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ù…Ø«Ø§Ù„: 249912345678)</p>
    <input type="number" id="startNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (12 Ø±Ù‚Ù…)">
    <input type="text" id="contactName" placeholder="Ø§Ø³Ù… Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„ (Ù…Ø«Ù„Ø§Ù‹: Ø²Ø¨ÙˆÙ†)">
    <input type="number" id="count" placeholder="ÙƒÙ… Ø±Ù‚Ù… ØªØ±ÙŠØ¯ ØªÙˆÙ„ÙŠØ¯Ù‡ØŸ">
    
    <button class="btn-gen" onclick="generateSequential()">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØ³Ù„Ø³Ù„Ø©</button>
    
    <div style="display: flex; justify-content: space-between;">
        <button id="excelBtn" style="background:#1D6F42" onclick="exportToExcel(this)">ØªØ­Ù…ÙŠÙ„ Excel</button>
        <button id="vcfBtn" class="btn-vcf" onclick="exportToVCF(this)">ØªØ­Ù…ÙŠÙ„ VCF</button>
    </div>

    <div id="tableContainer"></div>
</div>

<script>
    let currentNumbers = [];

    function generateSequential() {
        const startNum = document.getElementById('startNumber').value;
        const count = parseInt(document.getElementById('count').value);
        const container = document.getElementById('tableContainer');
        
        if (startNum.length < 10) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¨Ø¯Ø§ÙŠØ© ØµØ­ÙŠØ­");
        if (!count || count <= 0) return alert("Ø­Ø¯Ø¯ Ø§Ù„ÙƒÙ…ÙŠØ©");

        currentNumbers = [];
        let html = "<table><tr><th>Ø§Ù„Ø±Ù‚Ù…</th><th>ÙØ­Øµ</th></tr>";
        let currentTemp = BigInt(startNum); // Ø§Ø³ØªØ®Ø¯Ø§Ù… BigInt Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙƒØ¨ÙŠØ±Ø©

        for (let i = 0; i < count; i++) {
            let numStr = (currentTemp + BigInt(i)).toString();
            currentNumbers.push(numStr);
            html += `<tr id="row-${i}">
                        <td>${numStr}</td>
                        <td><a href="https://wa.me/${numStr}" target="_blank" class="wa-link" onclick="markRow(${i})">ÙˆØ§ØªØ³Ø§Ø¨</a></td>
                    </tr>`;
        }
        container.innerHTML = html + "</table>";
    }

    function markRow(index) {
        document.getElementById(`row-${index}`).classList.add('row-checked');
    }

    function exportToVCF(btn) {
        const baseName = document.getElementById('contactName').value || "Ø³ÙˆØ¯Ø§Ù†ÙŠ";
        if (currentNumbers.length === 0) return;
        let vcf = "";
        currentNumbers.forEach((n, i) => {
            vcf += `BEGIN:VCARD\nVERSION:3.0\nFN:${baseName} ${i+1}\nTEL;TYPE=CELL:+${n}\nEND:VCARD\n`;
        });
        const blob = new Blob([vcf], { type: "text/vcard" });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = `${baseName}.vcf`;
        a.click();
        btn.classList.add('btn-clicked');
    }

    function exportToExcel(btn) {
        if (currentNumbers.length === 0) return;
        const ws = XLSX.utils.json_to_sheet(currentNumbers.map(n => ({ "Ø§Ù„Ø±Ù‚Ù…": n })));
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Numbers");
        XLSX.writeFile(wb, "Sudan_Sequential.xlsx");
        btn.classList.add('btn-clicked');
    }
</script>
</body>
</html>
