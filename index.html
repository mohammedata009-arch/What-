<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ù…Ø­Ù…Ø¯ Ø·Ù‡ - Ø§Ù„Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…Ù„ÙˆÙ†</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f2f5; text-align: center; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 550px; margin: auto; }
        h2 { color: #075e54; margin-bottom: 5px; }
        .dev-name { color: #555; font-size: 14px; margin-bottom: 20px; }
        input, select { padding: 12px; margin: 8px 0; width: 95%; border-radius: 8px; border: 1px solid #ccc; font-size: 15px; box-sizing: border-box; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        button { padding: 14px; margin: 5px 0; width: 48%; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; color: white; transition: 0.3s; }
        .btn-gen { background: #25D366; width: 100%; }
        .btn-vcf { background: #007bff; width: 100%; }
        .btn-excel { background: #1D6F42; }
        .btn-copy { background: #333; }
        .btn-invite { background: #e91e63; width: 100%; }

        /* Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· (ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„) */
        .btn-clicked { background: #aaa !important; color: #666 !important; position: relative; }
        .btn-clicked::after { content: " (ØªÙ…)"; font-size: 10px; }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
        table { width: 100%; margin-top: 20px; border-collapse: collapse; font-size: 14px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; transition: 0.3s; }
        th { background: #075e54; color: white; }
        
        /* Ø­Ø§Ù„Ø© Ø§Ù„ØµÙ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· (ØªÙ… Ø§Ù„ÙØ­Øµ) */
        .row-checked { background-color: #d1e7dd !important; color: #0f5132; font-weight: bold; }
        .row-checked td { border-color: #badbcc; }

        .wa-link { color: #25D366; text-decoration: none; font-weight: bold; padding: 5px 10px; border: 1px solid #25D366; border-radius: 5px; }
        .wa-link:visited { color: #128C7E; }
    </style>
</head>
<body>

<div class="container">
    <h2>Ù…ÙˆÙ„Ø¯ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø³ÙˆØ¯Ø§Ù† ğŸ‡¸ğŸ‡©</h2>
    <div class="dev-name">Ø§Ù„Ù…Ø·ÙˆØ±: Ù…Ø­Ù…Ø¯ Ø·Ù‡ Ø¹Ø·Ø§ Ø§Ù„Ù…Ù†Ø§Ù†</div>
    
    <select id="network">
        <option value="+24991">Ø²ÙŠÙ† Ø§Ù„Ø³ÙˆØ¯Ø§Ù† (91)</option>
        <option value="+24912">Ø³ÙˆØ¯Ø§Ù†ÙŠ (12)</option>
        <option value="+24992">Ø£Ø±ÙˆÙŠØ¯Ùˆ (92)</option>
    </select>

    <input type="text" id="contactName" placeholder="Ø§Ø³Ù… Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„">
    <input type="number" id="count" placeholder="ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…ØŸ">
    
    <button class="btn-gen" onclick="generateNumbers(this)">1. ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</button>
    
    <div style="display: flex; justify-content: space-between;">
        <button id="excelBtn" class="btn-excel" onclick="exportToExcel(this)">ØªØ­Ù…ÙŠÙ„ Excel</button>
        <button class="btn-copy" onclick="copyNumbers(this)">Ù†Ø³Ø® Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</button>
    </div>

    <button id="vcfBtn" class="btn-vcf" onclick="exportToVCF(this)">2. ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù (VCF)</button>

    <div id="tableContainer"></div>
</div>

<script>
    let currentNumbers = [];

    // Ø¯Ø§Ù„Ø© Ù„ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·
    function markBtnClicked(btn) {
        btn.classList.add('btn-clicked');
    }

    function generateNumbers(btn) {
        const prefix = document.getElementById('network').value;
        const count = document.getElementById('count').value;
        const container = document.getElementById('tableContainer');
        if (!count || count <= 0) return alert("Ø­Ø¯Ø¯ Ø§Ù„Ø¹Ø¯Ø¯");
        
        // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¹Ù†Ø¯ ØªÙˆÙ„ÙŠØ¯ Ø£Ø±Ù‚Ø§Ù… Ø¬Ø¯ÙŠØ¯Ø©
        document.getElementById('excelBtn').classList.remove('btn-clicked');
        document.getElementById('vcfBtn').classList.remove('btn-clicked');

        currentNumbers = [];
        let html = "<table><tr><th>Ø§Ù„Ø±Ù‚Ù…</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th></tr>";
        for (let i = 0; i < count; i++) {
            const num = prefix + Math.floor(1000000 + Math.random() * 8999999);
            currentNumbers.push(num);
            // Ø£Ø¶ÙÙ†Ø§ Ø¯Ø§Ù„Ø© markRow Ù„Ø¥Ø¶Ø§ÙØ© Ù„ÙˆÙ† Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø·
            html += `<tr id="row-${i}">
                        <td>${num}</td>
                        <td><a href="https://wa.me/${num}" target="_blank" class="wa-link" onclick="markRow(${i})">ÙØ­Øµ ÙˆØ§ØªØ³Ø§Ø¨</a></td>
                    </tr>`;
        }
        container.innerHTML = html + "</table>";
    }

    // Ø¯Ø§Ù„Ø© ØªÙ„ÙˆÙŠÙ† Ø§Ù„ØµÙ
    function markRow(index) {
        const row = document.getElementById(`row-${index}`);
        row.classList.add('row-checked');
    }

    function exportToVCF(btn) {
        const baseName = document.getElementById('contactName').value || "Ø³ÙˆØ¯Ø§Ù†ÙŠ";
        if (currentNumbers.length === 0) return alert("ÙˆÙ„Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹");
        
        let vcf = "";
        currentNumbers.forEach((n, i) => {
            vcf += `BEGIN:VCARD\nVERSION:3.0\nFN:${baseName} ${i+1}\nTEL;TYPE=CELL:${n}\nEND:VCARD\n`;
        });
        
        const blob = new Blob([vcf], { type: "text/vcard" });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = `${baseName}.vcf`;
        a.click();
        markBtnClicked(btn); // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø²Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    }

    function exportToExcel(btn) {
        if (currentNumbers.length === 0) return;
        const ws = XLSX.utils.json_to_sheet(currentNumbers.map(n => ({ "Ø§Ù„Ø±Ù‚Ù…": n })));
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Numbers");
        XLSX.writeFile(wb, "Sudan_Numbers.xlsx");
        markBtnClicked(btn); // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø²Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    }

    function copyNumbers(btn) {
        if (currentNumbers.length === 0) return;
        navigator.clipboard.writeText(currentNumbers.join("\n"));
        markBtnClicked(btn);
    }
</script>
</body>
</html>
